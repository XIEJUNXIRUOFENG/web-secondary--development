<h1 align="center">28所-应用页签iframe通信</h1>

## 资产配置

- ##### 无


------

## 配置项

- ##### 无
  

------

## 逻辑控制

- ##### 无

------

## Iframe配置

- ##### 参数

  > ###### 使用`postMessage`方法传参，`字段为id`，值`要以#3结尾`

  > ##### 参数数量不限，格式不限
  
  ```javascript
  // 传参格式(对象格式)
  { 
      id: 'a8b59a70-aa2a-1abf-7e00-c5feab31ce8f#3'，
      参数名称：参数
  	...
  }
  ```
  
- ##### 逻辑控制代码

  > ### `返回值的字段必须和代码里return的字段保持一致`

  ```javascript
  let session = JSON.parse(window.sessionStorage.getItem("iframe_sessionData"));
  let search = window.location.search;
      
  let urlParams = {};
  let urlStr = "";
  if (search.indexOf("?") != -1) {
    let arr = search.split("?");
    search = arr[1];
    let array = search.split("&");
    for (let i = 0; i < array.length; i++) {
      let arr2 = array[i];
      let arr3 = arr2.split("=");
      urlParams[arr3[0]] = arr3[1];
    }
  }
  
  session.forEach((item) => {
    if (item.id == urlParams.menuId) {
      for (let i in item) {
        if (i != "id") {
          urlParams[i] = item[i];
        }
      }
    }
  });
  
  let str = [];
  for (let i in urlParams) {
    str.push(`&${i}=${urlParams[i]}`);
  }
  urlStr = str.join("");
  urlStr = urlStr.replace("&", "?");
  
  return { urlStr }
  ```

------

## 页面配置

- 配置流程

  > ###### 配置页面 -> 设置 -> `左下角`打开`开启页面标签`开关 -> 选择二开插件 -> 确认 -> 保存页面

- 测试案例地址

  > http://10.15.111.9:12292/app/edit?appid=57267cd1-56f5-9948-b57f-a13cab197b1b&pId=622b18e8-6fe4-46d7-f219-a4891d504e13
